<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>API | LabsX402 TestLabs</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%23111' width='100' height='100' rx='8'/><text x='50' y='62' font-family='monospace' font-size='24' fill='%2300ff88' text-anchor='middle' font-weight='bold'>402</text><text x='50' y='82' font-family='monospace' font-size='14' fill='%23666' text-anchor='middle'>LAB</text></svg>">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    :root {
      --bg: #0a0a0a;
      --card: #111;
      --border: #222;
      --text: #c8c8c8;
      --dim: #666;
      --accent: #00ff88;
      --warn: #ff6b35;
    }
    
    body {
      font-family: 'JetBrains Mono', 'Fira Code', monospace;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      min-height: 100vh;
    }
    
    .container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 2rem;
    }
    
    nav {
      display: flex;
      gap: 1rem;
      padding: 1rem 0;
      border-bottom: 1px solid var(--border);
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }
    
    nav a {
      color: var(--dim);
      text-decoration: none;
      font-size: 0.85rem;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      transition: all 0.2s;
    }
    
    nav a:hover, nav a.active {
      color: var(--accent);
      background: rgba(0, 255, 136, 0.1);
    }
    
    h1 {
      font-size: 1.5rem;
      color: var(--accent);
      margin-bottom: 0.5rem;
    }
    
    h2 {
      font-size: 1.1rem;
      color: var(--text);
      margin: 2rem 0 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 1px solid var(--border);
    }
    
    h3 {
      font-size: 0.95rem;
      color: var(--accent);
      margin: 1.5rem 0 0.5rem;
    }
    
    p, li {
      color: var(--dim);
      font-size: 0.85rem;
    }
    
    .subtitle {
      color: var(--dim);
      font-size: 0.9rem;
      margin-bottom: 2rem;
    }
    
    .endpoint {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1rem;
      margin: 1rem 0;
    }
    
    .endpoint-header {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }
    
    .method {
      background: var(--accent);
      color: var(--bg);
      padding: 0.15rem 0.5rem;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: bold;
    }
    
    .method.post { background: #3b82f6; }
    
    .url {
      font-size: 0.9rem;
      color: var(--text);
    }
    
    pre {
      background: #0d0d0d;
      border: 1px solid var(--border);
      border-radius: 4px;
      padding: 1rem;
      overflow-x: auto;
      font-size: 0.8rem;
      margin: 0.5rem 0;
    }
    
    code {
      color: var(--accent);
    }
    
    .note {
      background: rgba(0, 255, 136, 0.05);
      border-left: 3px solid var(--accent);
      padding: 0.75rem 1rem;
      margin: 1rem 0;
      font-size: 0.8rem;
    }
    
    .warn {
      background: rgba(255, 107, 53, 0.1);
      border-left: 3px solid var(--warn);
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      font-size: 0.8rem;
    }
    
    th, td {
      text-align: left;
      padding: 0.5rem;
      border-bottom: 1px solid var(--border);
    }
    
    th {
      color: var(--dim);
      font-weight: normal;
    }
    
    .ai-badge {
      display: inline-block;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 0.15rem 0.5rem;
      border-radius: 4px;
      font-size: 0.7rem;
      margin-left: 0.5rem;
    }
    
    .copy-btn {
      background: var(--border);
      border: none;
      color: var(--dim);
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.7rem;
      float: right;
    }
    
    .copy-btn:hover {
      background: var(--accent);
      color: var(--bg);
    }
  </style>
</head>
<body>
  <div class="container">
    <nav>
      <a href="../index.html">home</a>
      <a href="anonymity.html">anonymity</a>
      <a href="compression.html">compression</a>
      <a href="verify.html">verify</a>
      <a href="compare.html">compare</a>
      <a href="lab.html">lab</a>
      <a href="api.html" class="active">api</a>
    </nav>
    
    <h1>// api <span class="ai-badge">AI-FRIENDLY</span></h1>
    <p class="subtitle">Machine-readable endpoints for programmatic verification. Designed for AI agents.</p>
    
    <div class="note">
      <strong>For AI Agents:</strong> All responses are JSON. No auth required for read endpoints.
      Use these to programmatically verify claims without browser interaction.
    </div>
    
    <h2>// constants</h2>
    
    <div class="endpoint">
      <pre><code>PROGRAM_ID = "8jrMsGNM9HwmPU94cotLQCxGu15iW7Mt3WZeggfwvv2x"
PDOX_TOKEN = "4ckvALSiB6Hii7iVY9Dt6LRM5i7xocBZ9yr3YGNtVRwF"
CONFIG_PDA = "HHefAxKZQqaLj3V2Hd9XfTBRPe8av4JTmvE4DWiygER8"
NETWORK    = "devnet"
RPC_URL    = "https://api.devnet.solana.com"</code></pre>
    </div>
    
    <h2>// verification endpoints</h2>
    
    <h3>1. Verify Program Exists</h3>
    <div class="endpoint">
      <div class="endpoint-header">
        <span class="method">GET</span>
        <span class="url">Solana RPC - getAccountInfo</span>
      </div>
      <p>Check if program is deployed and executable.</p>
      <button class="copy-btn" onclick="copyCode('verify-program')">copy</button>
      <pre id="verify-program"><code>curl -X POST https://api.devnet.solana.com -H "Content-Type: application/json" -d '{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "getAccountInfo",
  "params": [
    "8jrMsGNM9HwmPU94cotLQCxGu15iW7Mt3WZeggfwvv2x",
    {"encoding": "base64"}
  ]
}'</code></pre>
      <p><strong>Expected:</strong> <code>executable: true</code>, <code>owner: BPFLoaderUpgradeab1e...</code></p>
    </div>
    
    <h3>2. Verify PDOX Token</h3>
    <div class="endpoint">
      <div class="endpoint-header">
        <span class="method">GET</span>
        <span class="url">Solana RPC - getAccountInfo</span>
      </div>
      <p>Check token exists with Token-2022 program (transfer fee enabled).</p>
      <button class="copy-btn" onclick="copyCode('verify-token')">copy</button>
      <pre id="verify-token"><code>curl -X POST https://api.devnet.solana.com -H "Content-Type: application/json" -d '{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "getAccountInfo",
  "params": [
    "4ckvALSiB6Hii7iVY9Dt6LRM5i7xocBZ9yr3YGNtVRwF",
    {"encoding": "base64"}
  ]
}'</code></pre>
      <p><strong>Expected:</strong> <code>owner: TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb</code> (Token-2022)</p>
    </div>
    
    <h3>3. Verify GlobalConfig PDA</h3>
    <div class="endpoint">
      <div class="endpoint-header">
        <span class="method">GET</span>
        <span class="url">Solana RPC - getAccountInfo</span>
      </div>
      <p>Check config account exists and is owned by program.</p>
      <button class="copy-btn" onclick="copyCode('verify-config')">copy</button>
      <pre id="verify-config"><code>curl -X POST https://api.devnet.solana.com -H "Content-Type: application/json" -d '{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "getAccountInfo",
  "params": [
    "HHefAxKZQqaLj3V2Hd9XfTBRPe8av4JTmvE4DWiygER8",
    {"encoding": "base64"}
  ]
}'</code></pre>
      <p><strong>Expected:</strong> <code>owner: 8jrMsGNM9HwmPU94cotLQCxGu15iW7Mt3WZeggfwvv2x</code></p>
    </div>
    
    <h3>4. Fetch Recent Transactions</h3>
    <div class="endpoint">
      <div class="endpoint-header">
        <span class="method">GET</span>
        <span class="url">Solana RPC - getSignaturesForAddress</span>
      </div>
      <p>Get last 10 transactions for the program.</p>
      <button class="copy-btn" onclick="copyCode('recent-txs')">copy</button>
      <pre id="recent-txs"><code>curl -X POST https://api.devnet.solana.com -H "Content-Type: application/json" -d '{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "getSignaturesForAddress",
  "params": [
    "8jrMsGNM9HwmPU94cotLQCxGu15iW7Mt3WZeggfwvv2x",
    {"limit": 10}
  ]
}'</code></pre>
    </div>
    
    <h3>5. Verify Specific Transaction</h3>
    <div class="endpoint">
      <div class="endpoint-header">
        <span class="method">GET</span>
        <span class="url">Solana RPC - getTransaction</span>
      </div>
      <p>Get full transaction details including logs.</p>
      <button class="copy-btn" onclick="copyCode('verify-tx')">copy</button>
      <pre id="verify-tx"><code>curl -X POST https://api.devnet.solana.com -H "Content-Type: application/json" -d '{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "getTransaction",
  "params": [
    "YOUR_TX_SIGNATURE_HERE",
    {"encoding": "json", "maxSupportedTransactionVersion": 0}
  ]
}'</code></pre>
    </div>
    
    <h2>// verified transactions</h2>
    
    <p>Real transactions you can verify right now:</p>
    
    <table>
      <tr>
        <th>Type</th>
        <th>Signature</th>
        <th>Date</th>
      </tr>
      <tr>
        <td>Batch Settlement</td>
        <td><code>32YDUGw3BKUG31x...</code></td>
        <td>2025-11-29</td>
      </tr>
      <tr>
        <td>Anonymous Payment</td>
        <td><code>5b1MtoyhEkptTYh...</code></td>
        <td>2025-11-29</td>
      </tr>
      <tr>
        <td>Token Transfer</td>
        <td><code>5QHTuj3wJVjCt3o...</code></td>
        <td>2025-11-30</td>
      </tr>
      <tr>
        <td>Vault Payout</td>
        <td><code>pDVsbdY899Gsxzd...</code></td>
        <td>2025-11-30</td>
      </tr>
    </table>
    
    <h2>// merkle verification</h2>
    
    <h3>Compute Merkle Root (JavaScript)</h3>
    <div class="endpoint">
      <p>Verify compression claims by computing Merkle root locally.</p>
      <button class="copy-btn" onclick="copyCode('merkle-js')">copy</button>
      <pre id="merkle-js"><code>// Node.js / Browser
const crypto = require('crypto');

function sha256(data) {
  return crypto.createHash('sha256').update(data).digest('hex');
}

function computeMerkleRoot(leaves) {
  if (leaves.length === 0) return '';
  if (leaves.length === 1) return leaves[0];
  
  const hashedLeaves = leaves.map(l => sha256(l));
  const nextLevel = [];
  
  for (let i = 0; i < hashedLeaves.length; i += 2) {
    const left = hashedLeaves[i];
    const right = hashedLeaves[i + 1] || left;
    nextLevel.push(sha256(left + right));
  }
  
  return computeMerkleRoot(nextLevel);
}

// Test with sample intents
const intents = [
  '{"from":"wallet1","to":"wallet2","amount":100}',
  '{"from":"wallet3","to":"wallet4","amount":50}',
  // ... up to 1,000,000 intents
];

console.log('Merkle Root:', computeMerkleRoot(intents));
// Single 32-byte root commits to ALL intents</code></pre>
    </div>
    
    <h3>Compute Merkle Root (Python)</h3>
    <div class="endpoint">
      <button class="copy-btn" onclick="copyCode('merkle-py')">copy</button>
      <pre id="merkle-py"><code>import hashlib
import json

def sha256(data: str) -> str:
    return hashlib.sha256(data.encode()).hexdigest()

def compute_merkle_root(leaves: list) -> str:
    if not leaves:
        return ''
    if len(leaves) == 1:
        return leaves[0]
    
    hashed = [sha256(l) for l in leaves]
    next_level = []
    
    for i in range(0, len(hashed), 2):
        left = hashed[i]
        right = hashed[i + 1] if i + 1 < len(hashed) else left
        next_level.append(sha256(left + right))
    
    return compute_merkle_root(next_level)

# Test
intents = [
    json.dumps({"from": "wallet1", "to": "wallet2", "amount": 100}),
    json.dumps({"from": "wallet3", "to": "wallet4", "amount": 50}),
]

print(f"Merkle Root: {compute_merkle_root(intents)}")</code></pre>
    </div>
    
    <h2>// anonymity math</h2>
    
    <h3>Calculate Anonymity Set</h3>
    <div class="endpoint">
      <p>Verify anonymity percentage claims.</p>
      <button class="copy-btn" onclick="copyCode('anon-math')">copy</button>
      <pre id="anon-math"><code>// Anonymity calculation
function calculateAnonymity(realUsers, ghostsPerUser, layers = 1) {
  const setSize = realUsers + (realUsers * ghostsPerUser);
  const perLayerProb = 1 / setSize;
  const totalProb = Math.pow(perLayerProb, layers);
  const anonymityPercent = (1 - totalProb) * 100;
  
  return {
    setSize,
    traceChance: totalProb,
    traceOdds: `1 in ${Math.round(1 / totalProb).toLocaleString()}`,
    anonymityPercent: anonymityPercent.toFixed(6) + '%'
  };
}

// STANDARD tier: 12 candidates (10 ghosts + 2 real)
console.log('STANDARD:', calculateAnonymity(2, 5, 1));
// { setSize: 12, traceChance: 0.0833, traceOdds: "1 in 12", anonymityPercent: "91.666667%" }

// MAX tier: 1000+ set
console.log('MAX:', calculateAnonymity(100, 9, 1));
// { setSize: 1000, traceChance: 0.001, traceOdds: "1 in 1,000", anonymityPercent: "99.900000%" }

// PARADOX tier: 10 layers
console.log('PARADOX:', calculateAnonymity(100, 9, 10));
// { setSize: 1000, traceChance: 1e-30, traceOdds: "1 in 1,000,000,000,000,000,000,000,000,000,000", anonymityPercent: "99.999999999999999999999999999900%" }</code></pre>
    </div>
    
    <h2>// cost calculation</h2>
    
    <div class="endpoint">
      <button class="copy-btn" onclick="copyCode('cost-calc')">copy</button>
      <pre id="cost-calc"><code>// Cost per intent calculation
function calculateCost(intentsInBatch, solanaFeePerTx = 0.000005) {
  // 1 on-chain TX settles entire batch
  const onChainTxs = 1;
  const totalSolanaFee = onChainTxs * solanaFeePerTx;
  const costPerIntent = totalSolanaFee / intentsInBatch;
  
  // Compare to individual TXs
  const individualCost = intentsInBatch * solanaFeePerTx;
  const savings = ((individualCost - totalSolanaFee) / individualCost) * 100;
  
  return {
    batchSize: intentsInBatch,
    totalCost: totalSolanaFee.toFixed(8) + ' SOL',
    costPerIntent: costPerIntent.toExponential(2) + ' SOL',
    individualCost: individualCost.toFixed(6) + ' SOL',
    savings: savings.toFixed(2) + '%'
  };
}

console.log('10K batch:', calculateCost(10000));
// { batchSize: 10000, totalCost: "0.00000500 SOL", costPerIntent: "5.00e-10 SOL", savings: "99.99%" }

console.log('1M batch:', calculateCost(1000000));
// { batchSize: 1000000, totalCost: "0.00000500 SOL", costPerIntent: "5.00e-12 SOL", savings: "99.9999%" }</code></pre>
    </div>
    
    <h2>// ai agent instructions</h2>
    
    <div class="note">
      <strong>For Claude/GPT/Grok:</strong> To verify PHANTOMGRID-Paradox claims:
      <ol style="margin-top: 0.5rem; padding-left: 1.5rem;">
        <li>Use curl commands above to query Solana devnet RPC directly</li>
        <li>Verify program exists and is executable</li>
        <li>Verify PDOX token uses Token-2022 (transfer fee enabled)</li>
        <li>Fetch recent transactions and check they're successful</li>
        <li>Run Merkle/anonymity/cost code locally to verify math claims</li>
        <li>Compare results to claims on main page</li>
      </ol>
    </div>
    
    <div class="warn note">
      <strong>Limitations:</strong>
      <ul style="margin-top: 0.5rem; padding-left: 1.5rem;">
        <li>This is DEVNET - not production/mainnet</li>
        <li>Benchmarks are from controlled tests, not organic load</li>
        <li>Anonymity is statistical mixing, not ZK proofs</li>
        <li>Large batch sizes (1M+) are theoretical targets</li>
      </ul>
    </div>
    
    <h2>// quick verify script</h2>
    
    <div class="endpoint">
      <p>One-liner to verify program is live:</p>
      <button class="copy-btn" onclick="copyCode('quick-verify')">copy</button>
      <pre id="quick-verify"><code># Bash - verify program exists
curl -s -X POST https://api.devnet.solana.com \
  -H "Content-Type: application/json" \
  -d '{"jsonrpc":"2.0","id":1,"method":"getAccountInfo","params":["8jrMsGNM9HwmPU94cotLQCxGu15iW7Mt3WZeggfwvv2x",{"encoding":"base64"}]}' \
  | jq '.result.value.executable'

# Expected output: true</code></pre>
    </div>
    
    <p style="margin-top: 3rem; color: var(--dim); font-size: 0.75rem; text-align: center;">
      LabsX402 TestLabs // Machine-readable verification // November 2025
    </p>
  </div>
  
  <script>
    function copyCode(id) {
      const code = document.getElementById(id).innerText;
      navigator.clipboard.writeText(code);
      event.target.innerText = 'copied!';
      setTimeout(() => event.target.innerText = 'copy', 1500);
    }
  </script>
</body>
</html>

